<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="FolderSync.App.HistoryPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:helpers="clr-namespace:FolderSync.App.Helpers"
    xmlns:models="clr-namespace:FolderSync.Data.Entities;assembly=FolderSync.Data"
    xmlns:vm="clr-namespace:FolderSync.App.ViewModels"
    Title="{helpers:Translate ActivityLog}">

    <Grid RowDefinitions="Auto,*">
        <!--  Header  -->
        <HorizontalStackLayout Grid.Row="0" Margin="20,10">
            <Label
                FontAttributes="Bold"
                FontSize="18"
                Text="{helpers:Translate RecentActivity}"
                VerticalOptions="Center" />
            <Button
                Margin="15,0,0,0"
                Padding="10,0"
                Command="{Binding LoadHistoryCommand}"
                FontSize="12"
                HeightRequest="30"
                Text="{helpers:Translate Refresh}"
                VerticalOptions="Center" />
        </HorizontalStackLayout>

        <!--  List  -->
        <CollectionView
            Grid.Row="1"
            Margin="15,5"
            ItemsSource="{Binding HistoryRecords}">
            <CollectionView.EmptyView>
                <Label
                    HorizontalOptions="Center"
                    Text="{helpers:Translate NoActivity}"
                    VerticalOptions="Center" />
            </CollectionView.EmptyView>
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:SyncHistory">
                    <Border
                        Margin="0,4"
                        Padding="12"
                        BackgroundColor="{AppThemeBinding Light=#FFFFFF,
                                                          Dark=#1F2937}"
                        StrokeShape="RoundRectangle 8"
                        StrokeThickness="0">
                        <Grid ColumnDefinitions="40,*,Auto">
                            <!--  Status Icon (Placeholder text for now)  -->
                            <Label
                                Grid.Column="0"
                                FontAttributes="Bold"
                                FontSize="10"
                                HorizontalOptions="Center"
                                Text="{Binding Status}"
                                TextColor="{AppThemeBinding Light=#6B7280,
                                                            Dark=#9CA3AF}"
                                VerticalOptions="Center" />

                            <!--  Main Info  -->
                            <VerticalStackLayout
                                Grid.Column="1"
                                Margin="10,0"
                                Spacing="2">
                                <Label
                                    FontAttributes="Bold"
                                    FontSize="14"
                                    LineBreakMode="MiddleTruncation"
                                    Text="{Binding FilePath}" />
                                <HorizontalStackLayout Spacing="5">
                                    <Label
                                        FontSize="12"
                                        Text="{Binding Operation}"
                                        TextColor="{AppThemeBinding Light=#4B5563,
                                                                    Dark=#D1D5DB}" />
                                    <Label
                                        FontSize="12"
                                        Text="â€¢"
                                        TextColor="Gray" />
                                    <Label
                                        FontSize="12"
                                        Text="{Binding SourceDeviceId}"
                                        TextColor="Gray" />
                                </HorizontalStackLayout>
                            </VerticalStackLayout>

                            <!--  Timestamp  -->
                            <Label
                                Grid.Column="2"
                                FontSize="11"
                                Text="{Binding Timestamp, StringFormat='{0:MM/dd HH:mm}'}"
                                TextColor="{AppThemeBinding Light=#6B7280,
                                                            Dark=#9CA3AF}"
                                VerticalOptions="Center" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>
